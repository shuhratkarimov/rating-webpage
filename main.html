<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Musobaqa uchun</title>
    <link
      rel="icon"
      href="https://cdn-icons-png.flaticon.com/128/15379/15379746.png"
      type="image/x-icon"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Heebo:wght@100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: sans-serif;
        background: #eef2f3;
        text-align: center;
        margin: 0;
        padding: 0;
        transition: background-color 1s ease;
      }
      h1 {
        margin-top: 20px;
        animation: fadeIn 1s ease-out;
      }

      .group {
        background-color: #ffffff88;
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }

      ul {
        list-style-type: none;
        padding-left: 0;
        margin-top: 10px;
      }

      .student-name {
        background: #e0f7fa;
        margin: 5px 0;
        padding: 8px 12px;
        border-radius: 8px;
        font-weight: 500;
        color: #00796b;
        transition: background 0.3s ease;
      }

      .student-name:hover {
        background: #b2ebf2;
      }

      .no-student {
        color: #aaa;
        font-style: italic;
        margin-top: 5px;
      }

      #ranking {
        margin: 20px auto;
        width: 300px;
        padding: 10px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 30px 30px 20px rgb(82, 82, 99);
        opacity: 0;
        animation: fadeInUp 1s ease-out forwards;
      }

      .group {
        background: #fff;
        display: inline-block;
        margin: 15px 15px;
        box-shadow: 30px 30px 20px rgb(82, 82, 99);
        padding: 20px;
        width: 320px;
        border-radius: 10px;
        transform: translateY(50px);
        opacity: 0;
        animation: slideIn 1s ease-out forwards;
        transition: transform 0.3s ease-in-out;
      }

      .group:hover {
        transform: scale(1.05);
        opacity: 1 !important;
      }

      .score {
        font-size: 36px;
        margin: 10px 0;
        color: #3e8e41;
        transition: color 0.3s ease;
      }

      .score:hover {
        color: #ff5733;
        opacity: 1;
      }

      button {
        padding: 8px 12px;
        margin: 5px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        transition: transform 0.2s ease;
      }

      button:hover {
        transform: scale(1.1);
        background-color: #3498db;
        color: white;
        opacity: 1;
      }

      .background-layer {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        transition: opacity 1s ease;
      }

      .layer-1 {
        opacity: 1;
      }

      .layer-2 {
        opacity: 0;
      }

      @keyframes wiggle {
        0% {
          transform: rotate(0deg);
        }
        25% {
          transform: rotate(45deg);
        }
        50% {
          transform: rotate(-45deg);
        }
        75% {
          transform: rotate(45deg);
        }
        100% {
          transform: rotate(0deg);
        }
      }

      .score.active {
        animation: wiggle 0.5s ease;
      }

      .bird {
        position: absolute;
        font-size: 24px;
        pointer-events: none;
        animation: fly 2s ease forwards;
      }

      @keyframes fly {
        0% {
          opacity: 1;
          transform: translate(1, -20px) rotate(0deg);
        }
        30% {
          opacity: 1;
          transform: translate(0, -60px) rotate(30deg);
        }
        50% {
          opacity: 1;
          transform: translate(0, -20px) rotate(20deg);
        }
        100% {
          opacity: 0;
          transform: translate(
              calc(100px * var(--dx)),
              calc(-200px + 100px * var(--dy))
            )
            rotate(200deg);
        }
      }

      @keyframes fadeOut {
        0% {
          opacity: 0.7;
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes move {
        0% {
          transform: translate(0, 0);
        }
        100% {
          transform: translate(calc(50px * var(--dx)), calc(50px * var(--dy)));
        }
      }

      @keyframes fadeIn {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      @keyframes fadeInUp {
        0% {
          opacity: 0;
          transform: translateY(20px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideIn {
        0% {
          opacity: 0;
          transform: translateY(50px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      li {
        opacity: 0;
        animation: fadeIn 0.5s ease-out forwards;
      }

      li:nth-child(odd) {
        animation-delay: 0.2s;
      }

      li:nth-child(even) {
        animation-delay: 0.4s;
      }
    </style>
  </head>
  <body>
    <h1 style="font-family: Bungee Spice">üèÜ Fullstack XN1 üí™</h1>
    <button
      id="resetButton"
      style="
        padding: 10px 20px;
        box-shadow: 30px 30px 20px rgb(82, 82, 99);
        font-size: 16px;
        cursor: pointer;
        background-color: #ff4d4d;
        color: white;
        border: none;
        border-radius: 5px;
        margin-bottom: 20px;
      "
    >
      Hammasini Reset Qilish
    </button>
    <div class="background-layer layer-1"></div>
    <div class="background-layer layer-2"></div>
    <div id="ranking">
      <h3>üîù Hozirgi Reyting:</h3>
      <ul id="rankingList" style="list-style: none; padding: 0"></ul>
    </div>

    <div id="groupsContainer"></div>
    <button class="nextPageBtn" onclick="nextPage()">Reytinglarni ko'rish</button>

    <script>
      const groups = [
        {
          name: "Kod ustalariüí™",
          key: "group1",
          students: JSON.parse(localStorage.getItem("group1")) || []
        },
        {
          name: "Haqiqiy Fullstackchilarüòé",
          key: "group2",
          students: JSON.parse(localStorage.getItem("group2")) || []
        },
        {
          name: "Doim birinchilar1Ô∏è‚É£",
          key: "group3",
          students: JSON.parse(localStorage.getItem("group3")) || []
        }
      ];

      const scores = {};
      
      // LocalStorage'dan ballarni o'qish
      groups.forEach(group => {
        const storedScore = localStorage.getItem(group.name);
        scores[group.name] = storedScore ? parseInt(storedScore) : 0;
      });

      const container = document.getElementById("groupsContainer");

      function createGroupUI(group) {
        const div = document.createElement("div");
        div.className = "group";
        
        const studentListHTML = group.students.length
          ? group.students
              .map(
                (student) => `<li class="student-name">${student.trim()}</li>`
              )
              .join("")
          : `<li class="no-student">Dasturchi yo'q</li>`;

        div.innerHTML = `
          <h2>${group.name}</h2>
          <div class="score" id="score-${group.name}">${scores[group.name]}</div>
          <button onclick="addScore('${group.name}', 10)">+10</button>
          <button onclick="addScore('${group.name}', 5)">+5</button>
          <button onclick="addScore('${group.name}', -5)">-5</button>
          <h4>Dasturchilar:</h4>
          <ul id="students-${group.key}">${studentListHTML}</ul>
          <button onclick="clearStudents('${group.key}')">Dasturchilarni tozalash</button>
        `;
        container.appendChild(div);
      }

      function renderRanking() {
        const list = document.getElementById("rankingList");
        list.innerHTML = "";
        const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
        sorted.forEach(([name, score], index) => {
          const li = document.createElement("li");
          const medal =
            index === 0 ? "ü•á" : index === 1 ? "ü•à" : index === 2 ? "ü•â" : "";
          li.textContent = `${medal} ${name}: ${score} ball`;
          list.appendChild(li);
        });
      }

      window.addScore = function (name, amount) {
        scores[name] += amount;
        const scoreElement = document.getElementById(`score-${name}`);
        scoreElement.innerText = scores[name];
        scoreElement.classList.add("active");

        const rect = scoreElement.getBoundingClientRect();
        for (let i = 0; i < 7; i++) {
          const bird = document.createElement("div");
          bird.className = "bird";
          bird.innerText = "Malades fullstack!üòäüëç";
          bird.style.left = `${rect.left + rect.width / 2 - 12}px`;
          bird.style.top = `${rect.top - 12}px`;

          const dx = Math.random() * 2;
          const dy = Math.random() * 2 - 4;
          bird.style.setProperty("--dx", dx);
          bird.style.setProperty("--dy", dy);

          document.body.appendChild(bird);

          setTimeout(() => {
            bird.remove();
          }, 3000);
        }

        localStorage.setItem(name, scores[name]);
        renderRanking();
      };

      function resetScores() {
        groups.forEach(group => {
          scores[group.name] = 0;
          localStorage.setItem(group.name, 0);
          const scoreElement = document.getElementById(`score-${group.name}`);
          if (scoreElement) {
            scoreElement.innerText = 0;
          }
        });
        renderRanking();
      }

      document
        .getElementById("resetButton")
        .addEventListener("click", resetScores);

      // Boshlanishda UI yasash
      groups.forEach(group => createGroupUI(group));
      renderRanking();

      const layer1 = document.querySelector(".layer-1");
      const layer2 = document.querySelector(".layer-2");
      let isLayer1Active = true;

      function getRandomGradient() {
        const r1 = Math.floor(Math.random() * 255);
        const g1 = Math.floor(Math.random() * 255);
        const b1 = Math.floor(Math.random() * 255);
        const r2 = Math.floor(Math.random() * 255);
        const g2 = Math.floor(Math.random() * 255);
        const b2 = Math.floor(Math.random() * 255);
        const r3 = Math.floor(Math.random() * 255);
        const g3 = Math.floor(Math.random() * 255);
        const b3 = Math.floor(Math.random() * 255);
        const r4 = Math.floor(Math.random() * 255);
        const g4 = Math.floor(Math.random() * 255);
        const b4 = Math.floor(Math.random() * 255);
        return `linear-gradient(200deg, rgb(${r1}, ${g1}, ${b1}), rgb(${r2}, ${g2}, ${b2}), rgb(${r3}, ${g3}, ${b3}), rgb(${r4}, ${g4}, ${b4}))`;
      }

      layer1.style.background = getRandomGradient();

      setInterval(() => {
        if (isLayer1Active) {
          layer2.style.background = getRandomGradient();
          layer2.style.opacity = 1;
          layer1.style.opacity = 0;
        } else {
          layer1.style.background = getRandomGradient();
          layer1.style.opacity = 1;
          layer2.style.opacity = 0;
        }
        isLayer1Active = !isLayer1Active;
      }, 10000);

      function clearStudents(groupKey) {
        localStorage.removeItem(groupKey);
        const group = groups.find(g => g.key === groupKey);
        if (group) {
          group.students = [];
          const studentListElement = document.getElementById(`students-${groupKey}`);
          if (studentListElement) {
            studentListElement.innerHTML = "<li class='no-student'>Dasturchi yo'q</li>";
          }
        }
      }

      function nextPage(){
        window.location.href = "rating-list.html"
      }
    </script>
  </body>
</html>